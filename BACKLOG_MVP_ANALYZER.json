{
  "issues": [
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A1 — Инициализация проекта анализатора (uv + структура)",
      "body": "Инициализировать подпроект `analyzer/` с `uv`. Разложить каталоги (`src/`, `tests/`, `assets/fixtures/`, `scripts/`), настроить logging, конфиг через аргументы CLI.\n**Критерии приёмки**\n- `uv.lock` присутствует, пины версий зафиксированы\n- `analyzer --help` выводит список аргументов\n- Логи в stdout: `INFO/DEBUG`\n\n**Зависимости:** —\n**Заметки:** Python 3.11+, `librosa`, `soundfile`, `numpy` (опц. `opencv-python-headless`).",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": []
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A2 — Экстракция аудио через ffmpeg",
      "body": "Извлечение моно WAV 22.05kHz из входного mp4/mov.\n**Критерии приёмки**\n- Создаётся temp WAV и корректно удаляется\n- Ошибки ffmpeg репортятся понятным сообщением\n\n**Зависимости:** A1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A1"
      ]
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A3 — Новизна аудио: onset strength + spectral contrast variance",
      "body": "Подсчёт novelty score: onset strength (proxy spectral flux) + дисперсия spectral contrast; robust-нормализация; сглаживание ~0.5s.\n**Критерии приёмки**\n- Возвращается временная ось и нормированный скор 0..1\n- Unit-тест на синтетике (импульсы → пики)\n\n**Зависимости:** A2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": [
        "A2"
      ]
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A4 — Пик-пикинг с минимальным разнесением (spacing) и top-K",
      "body": "Жадный выбор топ-K пиков по скору с ограничением минимального расстояния.\n**Критерии приёмки**\n- Для 1ч и `K=6`,`spacing=80` выдаёт ≤6 пиков\n- Тест: синтетические пики корректно «разрежаются»\n\n**Зависимости:** A3",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A3"
      ]
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A5 — Seed-таймкоды: парсинг и локальный пик в окне",
      "body": "Поддержка аргумента `--seeds \"HH:MM:SS,...\"`. Вокруг seed искать локальный максимум в окне ±15–20s. Объединить с авто-пиками с учётом `spacing`.\n**Критерии приёмки**\n- Валидируется формат; ошибки парсинга → понятные\n- При конфликтах выполняется правило `spacing`\n\n**Зависимости:** A4",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A4"
      ]
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A6 — Преролл −10s и построение сегментов (min/max длина)",
      "body": "Для каждого центра выставить `start = max(0, t* - pre)`; длина `[minLen,maxLen]`.\n**Критерии приёмки**\n- Нет выходов за пределы длительности\n- JSON/CSV содержит `start/end/center/score`\n\n**Зависимости:** A5",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A5"
      ]
    },
    {
      "epic": "EPIC_A_BASE_ANALYZER",
      "title": "[EPIC_A_BASE_ANALYZER] A7 — Вывод результатов: CSV + JSON (контракт)",
      "body": "Экспорт `highlights.csv` и `highlights.json`.\n**Критерии приёмки**\n- CSV: `clip_id,start,end,center,score,seed_based,aligned`\n- JSON: `clips[]`, `tempo_confidence`, версия схемы\n\n**Зависимости:** A6",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A6"
      ]
    },
    {
      "epic": "EPIC_B_BEAT_QUANT",
      "title": "[EPIC_B_BEAT_QUANT] B1 — Локальный BPM и сетка ударов",
      "body": "Оценить BPM и биты (`librosa.beat.beat_track`) в окне ±30–45s.\n**Критерии приёмки**\n- Возврат времён ударов, BPM, confidence [0..1]\n- На синтетике 4/4 ошибка ≤100ms\n\n**Зависимости:** A6",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": [
        "A6"
      ]
    },
    {
      "epic": "EPIC_B_BEAT_QUANT",
      "title": "[EPIC_B_BEAT_QUANT] B2 — Квантизация старта и длины клипа",
      "body": "Старт переносится на ближайший удар/бар **перед** `t_start`; длина = `N*bar` (N∈{8,12,16}).\n**Критерии приёмки**\n- `aligned=true` при успешной квантизации\n- Фоллбек при низкой уверенности\n\n**Зависимости:** B1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "B1"
      ]
    },
    {
      "epic": "EPIC_C_MOTION",
      "title": "[EPIC_C_MOTION] C1 — Оптический поток Farnebäck (3–4 fps) и смешивание со скором аудио",
      "body": "Оценка медианы модуля опт. потока; нормализация 0..1; интерполяция к оси аудио; `score = 0.6*audio + 0.4*motion`.\n**Критерии приёмки**\n- Флаг `--with_motion` включает смешивание\n- При недоступном видео — graceful degrade\n\n**Зависимости:** A3",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 1,
      "dependencies": [
        "A3"
      ]
    },
    {
      "epic": "EPIC_D_EXPORT",
      "title": "[EPIC_D_EXPORT] D1 — Оригинал 16:9 (stream copy / fallback h264)",
      "body": "Вырезка без перекодирования при совместимых кодеках; иначе `-c:v libx264 -crf 18 -preset veryfast`.\n**Критерии приёмки**\n- Для h264/aac — copy; иначе корректный транскод\n\n**Зависимости:** A7",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A7"
      ]
    },
    {
      "epic": "EPIC_D_EXPORT",
      "title": "[EPIC_D_EXPORT] D2 — Экспорт 9:16 и 1:1 (crop+scale)",
      "body": "Поддержка 1080×1920 и 1080×1080. Кроп по центру; `-pix_fmt yuv420p`, `-r 30`.\n**Критерии приёмки**\n- Ролики соответствуют целевым параметрам\n\n**Зависимости:** D1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": [
        "D1"
      ]
    },
    {
      "epic": "EPIC_D_EXPORT",
      "title": "[EPIC_D_EXPORT] D3 — (Опц.) Авто-рефрейм (HOG/pose) для вертикали/квадрата",
      "body": "Детекция людей → медианный центр X → кроп-окно вокруг центра.\n**Критерии приёмки**\n- В сценах с центром внимания кроп стабильный\n\n**Зависимости:** D2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P2",
      "estimate_days": 1.5,
      "dependencies": [
        "D2"
      ]
    },
    {
      "epic": "EPIC_E_CLI_INTEGRATION",
      "title": "[EPIC_E_CLI_INTEGRATION] E1 — CLI-контракт и JSON-схема",
      "body": "Флаги: `--input, --clips, --min_len, --max_len, --pre, --spacing, --with_motion, --align_to_beat, --seeds, --out_json, --out_csv`.\n**Критерии приёмки**\n- `--help` описывает флаги\n- JSON валидируется схемой\n\n**Зависимости:** A7, B2, D2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A7",
        "B2",
        "D2"
      ]
    },
    {
      "epic": "EPIC_E_CLI_INTEGRATION",
      "title": "[EPIC_E_CLI_INTEGRATION] E2 — Прогресс/ивенты в stdout (для SSE)",
      "body": "JSON-ивенты `stage`, `progress`, `message` в stdout.\n**Критерии приёмки**\n- Бэк проксирует в SSE\n\n**Зависимости:** A1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 0.5,
      "dependencies": [
        "A1"
      ]
    },
    {
      "epic": "EPIC_E_CLI_INTEGRATION",
      "title": "[EPIC_E_CLI_INTEGRATION] E3 — Отмена и управление ресурсами",
      "body": "Обработка SIGTERM/SIGINT, убийство дерева процессов ffmpeg/yt-dlp. Параметры `--threads`, `--ram_limit` (best effort).\n**Критерии приёмки**\n- Отмена завершает работу ≤5с, без «зомби»\n\n**Зависимости:** D1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 0.5,
      "dependencies": [
        "D1"
      ]
    },
    {
      "epic": "EPIC_F_TESTING",
      "title": "[EPIC_F_TESTING] F1 — Unit-тесты сигналов/пиков/квантизации",
      "body": "Синтетика: ритмы, импульсы, шум. Проверка пиков и beat-выравнивания.\n**Критерии приёмки**\n- Покрытие ключевых функций ≥70%\n\n**Зависимости:** A3, B2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": [
        "A3",
        "B2"
      ]
    },
    {
      "epic": "EPIC_F_TESTING",
      "title": "[EPIC_F_TESTING] F2 — Интеграционные тесты на коротких роликах",
      "body": "Фикстуры 5–10 мин; прогон end-to-end; валидация форматов/длин/количества клипов.\n\n**Зависимости:** D2, E1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 1,
      "dependencies": [
        "D2",
        "E1"
      ]
    },
    {
      "epic": "EPIC_F_TESTING",
      "title": "[EPIC_F_TESTING] F3 — Нагрузочные тесты и профилирование",
      "body": "Замер времени/CPU/RAM на 60‑мин сетах; цель ≤8 мин на 6 клипов; оптимизация параметров STFT/окон.\n\n**Зависимости:** D2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 1,
      "dependencies": [
        "D2"
      ]
    },
    {
      "epic": "EPIC_G_OBSERVABILITY",
      "title": "[EPIC_G_OBSERVABILITY] G1 — Метрики для Prometheus (stdout → бэк → /metrics)",
      "body": "Вернуть в финальном JSON/ивентах `timings` по стадиям, `novelty_peaks_count`, объёмы байт — для экспорта бэком.\n**Критерии приёмки**\n- Дашборд показывает `job_duration_seconds{stage}`/`novelty_peaks_count`\n\n**Зависимости:** E1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 0.5,
      "dependencies": [
        "E1"
      ]
    },
    {
      "epic": "EPIC_H_PACKAGING",
      "title": "[EPIC_H_PACKAGING] H1 — Dockerfile анализатора",
      "body": "Образ с ffmpeg, uv, зависимостями; кэширование слоёв.\n**Критерии приёмки**\n- `docker run analyzer …` работает локально/в Railway\n\n**Зависимости:** A1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P0",
      "estimate_days": 0.5,
      "dependencies": [
        "A1"
      ]
    },
    {
      "epic": "EPIC_H_PACKAGING",
      "title": "[EPIC_H_PACKAGING] H2 — CI: тесты, линтеры, безопасность",
      "body": "GitHub Actions: `ruff`, `black`, `mypy`, юнит/интеграционные тесты, кэш uv, SBOM/скан уязвимостей.\n**Критерии приёмки**\n- PR-проверки зелёные; артефакты тестов приложены\n\n**Зависимости:** F1, F2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 1,
      "dependencies": [
        "F1",
        "F2"
      ]
    },
    {
      "epic": "EPIC_I_EXPERIMENT",
      "title": "[EPIC_I_EXPERIMENT] I1 — Набор датасета и скрипт генерации A/B/C/D",
      "body": "Собрать 10 сетов (30–90 мин); генерация клипов вариантов A/B (+ C/D при флагах). Сбор таблицы метрик (beat error, proximity).\n\n**Зависимости:** B2, C1, D2",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P1",
      "estimate_days": 1,
      "dependencies": [
        "B2",
        "C1",
        "D2"
      ]
    },
    {
      "epic": "EPIC_I_EXPERIMENT",
      "title": "[EPIC_I_EXPERIMENT] I2 — Онлайн-оценка предпочтений пользователей",
      "body": "Небольшой фронт/формулик: «Выберите лучший из пары». Сбор ≥100 сравнений; расчёт `User Preference %`.\n\n**Зависимости:** I1",
      "labels": [
        "area:analyzer",
        "type:feature"
      ],
      "priority": "P2",
      "estimate_days": 1.5,
      "dependencies": [
        "I1"
      ]
    }
  ]
}